# drug-safety-mcp

MCP server generated by [@sineai/mcp-forge](https://dev.azure.com/sineai/Agents/_git/mcp-forge) v2.0.0

**Deployment Mode:** Standalone

## ğŸ” Authentication (Standalone Mode)

This MCP is configured for **Standalone Mode** - it handles its own authentication.

### Key Vault Secrets to Create

| Secret Name | Description |
|-------------|-------------|
| `auth-mode` | `azure_ad`, `api_key`, or `none` |
| `azure-tenant-id` | Azure AD tenant ID |
| `azure-client-id` | App registration client ID |
| `azure-allowed-groups` | Comma-separated group IDs |
| `api-keys` | Comma-separated API keys |

### Cursor Configuration (Direct)

```json
{
  "mcpServers": {
    "drug-safety-mcp": {
      "url": "https://<your-mcp-url>/mcp",
      "headers": {
        "Authorization": "Bearer <your-token>"
      }
    }
  }
}
```

## ğŸ“ Project Structure

```
src/
â”œâ”€â”€ tools/          âœï¸ Your tools - EDIT THIS!
â”‚   â”œâ”€â”€ definitions.ts Tool schemas
â”‚   â”œâ”€â”€ handlers.ts    Tool implementations
â”‚   â””â”€â”€ index.ts       Tool exports
â”‚
â””â”€â”€ index.ts        Entry point
```

ğŸ“¦ **Core functionality** (security, auth, server) comes from the `@sineai/mcp-core` package.

To update core (security fixes, new features):
```bash
npm run update:core
```

## ğŸš€ Quick Start

```bash
# Install dependencies
npm install

# Copy and configure environment
cp .env.example .env

# Run locally (stdio mode)
npm run dev

# Run in remote mode (HTTP/SSE)
npm run start:remote
```

## âœï¸ Adding Tools

1. **Define your tool** in `src/tools/definitions.ts`:

```typescript
{
  name: "search_issues",
  description: "Search Jira issues by project and status",
  inputSchema: {
    type: "object",
    properties: {
      project: { type: "string", description: "Project key" },
      status: { type: "string", description: "Issue status" },
    },
    required: ["project"],
  },
}
```

2. **Implement the handler** in `src/tools/handlers.ts`:

```typescript
async function handleSearchIssues(args: { project: string; status?: string }) {
  const jiraToken = await secrets.get("jira-api-token");
  // ... implementation
}
```

3. **Add to router** in `src/tools/handlers.ts`:

```typescript
case "search_issues":
  return handleSearchIssues(args);
```

## âš™ï¸ Configuration

All config is stored in **Azure Key Vault** - only the Key Vault name is needed in .env!

### .env (Minimal Config)

```env
# Only this is required for deployment!
AZURE_KEYVAULT_NAME=your-keyvault

# Optional (for local development)
MCP_MODE=local
PORT=3000
LOG_LEVEL=info
```

### Key Vault Secrets (One-Time Org Setup)

These secrets are shared by all MCPs - set once per organization:

| Secret | Description |
|--------|-------------|
| `azure-acr-name` | Container Registry name |
| `azure-resource-group` | Resource group for Container Apps |
| `azure-container-environment` | Container Apps environment |
| `mcp-gateway-url` | MCP Gateway URL (for gateway mode) |

## ğŸš€ Deployment

Deploy to Azure Container Apps:

```bash
npm run deploy
```

This will:
- Build TypeScript
- Build Docker image
- Push to Azure Container Registry
- Create/update Container App
- Grant Key Vault access

## ğŸ“Š Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `MCP_MODE` | `local` | `local` (stdio) or `remote` (HTTP) |
| `PORT` | `3000` | HTTP port (remote mode) |
| `AZURE_KEYVAULT_URL` | - | Key Vault URL |
| `LOG_LEVEL` | `info` | `debug`, `info`, `warn`, `error` |
